# 媒体通知 Webhook 插件

为 AstrBot 提供媒体服务器通知功能。原始逻辑来自 @CikeyQi

## 功能特性

- 📱 **智能消息** - 自动格式化，包含剧集信息和封面图片
- 🔄 **智能去重** - 防止重复通知
- 🎯 **数据丰富** - TMDB/BGM.TV 数据补全
- 🖼️ **图片降级** - 自动获取封面图片
- 📦 **批量发送** - 支持消息缓存和合并转发

## 配置

```json
{
  "webhook_port": 60071,
  "group_id": "your-group-id",
  "tmdb_api_key": "your-tmdb-key"
}
```

**媒体服务器设置**：
```
Webhook URL: http://your-bot-server:60071/media-webhook
```

**测试命令**：
```
/webhook test    # 测试功能
/webhook status  # 查看状态
```

## 使用说明

1. 配置插件参数
2. 在媒体服务器中设置 Webhook URL
3. 插件会自动接收并推送通知到指定群组

**智能发送策略**：
- **aiocqhttp**: 达到阈值时使用合并转发，减少刷屏
- **其他协议**: 自动降级为单独发送
- **智能缓存**: 根据 `batch_min_size` 配置智能缓存
- **超时发送**: 超过时间间隔自动发送队列中的消息


## 消息示例

```
🤖 📺 新剧集更新 [Jellyfin]

剧集名称: 进击的巨人 (2023)
集号: S04E28
集名称: 最终话

剧情简介:
艾伦·耶格尔的故事迎来最终章节...

时长: 24分钟
✨ 数据来源: TMDB
```

## 许可证

MIT License
